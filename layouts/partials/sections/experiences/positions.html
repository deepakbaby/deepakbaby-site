<div class="col-10 col-lg-8">
    <div class="experience-entry-heading">
        {{/* Column 1: Logo */}}
        {{ $logoImage:= resources.Get .company.logo}}
        {{ $darkLogoImage:= resources.Get .company.darkLogo}}
        {{ if $logoImage }}
        {{/* Resize and convert to WebP for better performance. Skip SVG files */}}
        {{ if ne $logoImage.MediaType.SubType "svg" }}
          {{ $logoImage = $logoImage.Resize "96x webp q85" }}
        {{ end }}
        {{ if and $darkLogoImage (ne $darkLogoImage.MediaType.SubType "svg") }}
          {{ $darkLogoImage = $darkLogoImage.Resize "96x webp q85" }}
        {{ end }}
        <div class="exp-logo-col">
            <img class="company-logo light-logo" src="{{ $logoImage.RelPermalink }}" alt="{{ .name }}" width="48" height="48" loading="lazy" />
            {{ if $darkLogoImage }}
            <img class="company-logo dark-logo" src="{{ $darkLogoImage.RelPermalink }}" alt="{{ .name }}" width="48" height="48" loading="lazy" />
            {{ end }}
        </div>
        {{ end }}

        {{/* Column 2: Company name and location */}}
        <div class="exp-info-col">
            <h5 class="company-name">{{ if .company.url }}<a href={{.company.url}} title="{{ .company.name }}" target="_blank" rel="noopener">{{ .company.name }}</a>{{ else }}{{ .company.name }}{{ end }}</h5>
            {{ if .company.location }}
            <p class="company-location text-muted mb-0">
                <i class="fa-solid fa-location-dot"></i> {{ .company.location }}
            </p>
            {{ end }}
        </div>

        {{/* Column 3: Dates - pushed to right */}}
        {{ $oldestPosition := index (last 1 .positions) 0}}
        {{ $mostRecentPosition := index (first 1 .positions) 0}}
        <div class="exp-dates-col">
            <p class="experience-dates text-muted mb-0">
                {{ $oldestPosition.start }} - {{ if $mostRecentPosition.end }}{{ $mostRecentPosition.end }}{{ else }}{{ i18n "present" }}{{ end }}
            </p>
        </div>
    </div>

    <!-- Add company overview -->
    {{ if .company.overview }}
    <p class="mt-2">{{ .company.overview | markdownify }}</p>
    {{ end }}
    <!-- Add the positions information with LinkedIn-style timeline -->
    <div class="positions-timeline">
    {{ $totalPositions := len .positions }}
    {{ range $index, $position := .positions }}
        <div class="position-entry {{ if eq $index 0 }}first{{ end }} {{ if eq $index (sub $totalPositions 1) }}last{{ end }}">
            <div class="timeline-marker">
                <div class="timeline-dot"></div>
                {{ if lt $index (sub $totalPositions 1) }}
                <div class="timeline-line"></div>
                {{ end }}
            </div>
            <div class="position-content">
                <div class="position-header">
                    <h5 class="designation">{{ $position.designation }}</h5>
                    <p class="position-dates text-muted">
                        {{ $position.start }} - {{if $position.end }} {{ $position.end }} {{else}} {{ i18n "present" }} {{end}}
                        <span class="position-duration" data-start="{{ $position.start }}" data-end="{{ if $position.end }}{{ $position.end }}{{ else }}{{ end }}"></span>
                    </p>
                </div>
                <!-- Add the responsibilities handled at this position -->
                {{ if $position.responsibilities }}
                    <ul class="position-responsibilities">
                        {{ range $position.responsibilities }}
                            <li>{{ . | markdownify }}</li>
                        {{ end }}
                    </ul>
                {{ end }}
            </div>
        </div>
    {{ end }}
    </div>
</div>
