<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">

<head>
  <title>{{ .Page.Title }}</title>

  <!------ PRECONNECT TO THIRD-PARTY ORIGINS FOR BETTER PERFORMANCE -------->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  <link rel="dns-prefetch" href="https://www.google-analytics.com">
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="dns-prefetch" href="https://www.googletagmanager.com">

  <!------ PWA MANIFEST -------->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#0f172a">

  <!------ RESOURCE PRELOADING FOR CRITICAL ASSETS -------->
  <link rel="preload" as="script" href="/js/collapsible-sidebars.js">

  <!------ ASYNC FONT LOADING - NON-BLOCKING (Optimized: reduced to 3 weights) -------->
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"></noscript>

  <!------ ADD COMMON HEADERS -------->
  <style>
    /* Global Theme CSS Variables */
    :root {
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --bg-card: rgba(255, 255, 255, 0.03);
      --text-primary: #fff;
      --text-secondary: #9ca3af;
      --text-muted: #6b7280;
      --border-color: rgba(255, 255, 255, 0.08);
      --orb-opacity: 0.5;
      --toggle-bg: rgba(255, 255, 255, 0.1);
      --toggle-border: rgba(255, 255, 255, 0.2);
      --social-bg: rgba(255, 255, 255, 0.05);
      --social-border: rgba(255, 255, 255, 0.1);
      --mouse-border: rgba(255, 255, 255, 0.2);
      --wheel-bg: rgba(255, 255, 255, 0.4);
      --card-hover-border: rgba(59, 130, 246, 0.3);
      --card-hover-shadow: rgba(59, 130, 246, 0.15);
    }

    [data-theme="light"] {
      --bg-primary: #fafbfc;
      --bg-secondary: #ffffff;
      --bg-card: transparent;
      --text-primary: #1e293b;
      --text-secondary: #475569;
      --text-muted: #94a3b8;
      --border-color: rgba(0, 0, 0, 0.06);
      --orb-opacity: 0.1;
      --toggle-bg: rgba(0, 0, 0, 0.04);
      --toggle-border: rgba(0, 0, 0, 0.08);
      --social-bg: transparent;
      --social-border: rgba(0, 0, 0, 0.1);
      --mouse-border: rgba(0, 0, 0, 0.12);
      --wheel-bg: rgba(0, 0, 0, 0.2);
      --card-hover-border: rgba(59, 130, 246, 0.3);
      --card-hover-shadow: rgba(59, 130, 246, 0.08);
      --card-bg: transparent;
      --card-border: rgba(0, 0, 0, 0.04);
      --timeline-color: #3b82f6;
      --section-bg: #ffffff;
      --glow-color: rgba(59, 130, 246, 0.08);
    }

    body {
      background-color: var(--bg-primary);
      color: var(--text-primary);
    }
  </style>
  {{- partial "header.html" . -}}
  {{- partial "opengraph.html" . -}}
  <!------ ADD PAGE SPECIFIC HEADERS ------->
  {{ block "header" . }} {{ end }}

  <!------ ADD CUSTOM CSS FOR COLLAPSIBLE SIDEBARS (Async Loading) ------->
  <link rel="stylesheet" href="/css/collapsible-sidebars.css" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="/css/collapsible-sidebars.css"></noscript>
  <!------ ADD CUSTOM CSS FOR COMMENTS (Async Loading) ------->
  <link rel="stylesheet" href="/css/comments.css" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="/css/comments.css"></noscript>

  <!--================= add analytics if enabled =========================-->
  {{- partial "analytics.html" . -}}
  {{ with resources.Get "scripts/core/theme-scheme.js" | fingerprint }}
  <script integrity="{{.Data.Integrity}}">
    {{ .Content | safeJS }}
  </script>
  {{ end }}
</head>

<body class="type-{{ .Page.Type }} kind-{{ .Page.Kind }}" data-bs-spy="scroll" data-bs-target="#TableOfContents"
  data-bs-offset="80">
  <div class="container-fluid wrapper">
    <!----- ADD NAVBAR --------------->
    {{ block "navbar" . }} {{ end }}

    <!----- ADD SIDEBAR --------------->
    {{ block "sidebar" . }} {{ end }}

    <!----- ADD PAGE CONTENT --------->
    {{ block "content" . }} {{ end }}

    <!----- ADD TABLE OF CONTENTS ----------->
    {{ block "toc" . }} {{ end }}
  </div>

  <!------- ADD FOOTER ------------>
  {{ $footerTemplate:= site.Params.footer.template | default "footer.html" }}
  {{- partial $footerTemplate . -}}

  <!------- ADD COMMON SCRIPTS ------->
  {{ partial "scripts.html" . }}

  <!------- ADD PAGE SPECIFIC SCRIPTS ------>
  {{ block "scripts" . }} {{ end }}

  <!------ ADD CUSTOM JS FOR COLLAPSIBLE SIDEBARS -------->
  <script src="/js/collapsible-sidebars.js" defer></script>

  <!------ IF WANTED, ADD SUPPORT LINKS -------->
  {{- partial "misc/support.html" . -}}

  <!------ SERVICE WORKER REGISTRATION -------->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js')
          .then(function(registration) {
            console.log('Service Worker registered with scope:', registration.scope);
          })
          .catch(function(error) {
            console.log('Service Worker registration failed:', error);
          });
      });
    }
  </script>

</body>

</html>